<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>LunchVerse Upload</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f0f0f;
  color: #fff;
  padding: 20px;
}

#dropzone {
  border: 2px dashed #555;
  padding: 40px;
  text-align: center;
  cursor: pointer;
  margin-bottom: 20px;
}

#dropzone:hover {
  background: #1a1a1a;
}

#files img {
  display: block;
  margin: 10px 0;
  max-width: 200px;
  border-radius: 6px;
}

a {
  color: #4ea1ff;
  display: block;
  margin: 5px 0;
}
</style>
</head>

<body>

<h1>LunchVerse</h1>

<div id="dropzone">
  Drag & drop a file here
</div>

<div id="files"></div>

<script>
const API = "https://lunchverse.free.nf/upload.php";
const filesBox = document.getElementById("files");
const dropzone = document.getElementById("dropzone");

// ================= LOAD FILES =================
async function loadFiles() {
  try {
    const res = await fetch(API);
    const data = await res.json();

    filesBox.innerHTML = "";

    if (data.length === 0) {
      filesBox.innerHTML = "<p>No uploads yet</p>";
      return;
    }

    data.forEach(f => {
      if (f.type === "image") {
        const img = document.createElement("img");
        img.src = f.url;
        filesBox.appendChild(img);
      } else {
        const a = document.createElement("a");
        a.href = f.url;
        a.target = "_blank";
        a.textContent = f.name;
        filesBox.appendChild(a);
      }
    });

  } catch (err) {
    console.error("LOAD ERROR:", err);
  }
}

// ================= UPLOAD =================
async function uploadFile(file) {
  const fd = new FormData();
  fd.append("file", file);

  try {
    const res = await fetch(API, {
      method: "POST",
      body: fd
    });

    const data = await res.json();
    console.log("UPLOAD:", data);

    if (data.ok) {
      loadFiles();
    } else {
      alert("Upload failed");
    }

  } catch (err) {
    console.error("UPLOAD ERROR:", err);
  }
}

// ================= DRAG & DROP =================
dropzone.addEventListener("dragover", e => {
  e.preventDefault();
});

dropzone.addEventListener("drop", e => {
  e.preventDefault();
  const file = e.dataTransfer.files[0];
  if (file) uploadFile(file);
});

// ================= INIT =================
loadFiles();
</script>

</body>
</html>